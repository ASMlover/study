# **类型与对象**
***

## **1. 术语**
    1) 每个对象都有一个身份(可看作内存中所指的指针)，一个类型和一个值；
    2) 对象类型用于描述对象的内部表示以及它支持的方法和操作；
    3) 对象的值可修改就是可变对象，如不可修改则为不可变对象；

## **2. 对象的身份与类型**
    1) id()返回对象的身份，返回值是一个整数；对应了该对象在内存中的位置；
    2) is运算符比较两个对象的身份；
    3) type()返回一个对象的类型；
    4) 对象的类型也是一个对象，为对象的类；该对象的定义是唯一的，对于某个类
       型的所有实例都是相同的；
    5) 类型之间使用is运算符进行比较；
    6) 检查类型的最佳方式是使用isinstance(object, type)；isinstance能实现继
       承，是检查所有Python对象类型的首选；

## **3. 引用计数与垃圾收集**
    1) 所有对象都有引用计数，给一个对象分配一个新名称，将对象放入一个容器，
       该对象的引用计数都会增加；
    2) 使用del语句或引用超出作用域时，对象的引用计数就会减少；
    3) 使用sys.getrefcount()可以获得对象当前的引用计数；
    4) 多数情况下，引用计数都比猜测的大；对于不可变数据，解释器会主动在程序
       的不同部分共享对象以节约内存；
    5) 当对象的引用计数归零时，它将被垃圾回收机制处理掉；
    6) 对于循环引用的对象，解释器会定期执行一个循环检测器，搜索不可访问对象
       的循环并删除它们；

## **4. 引用与复制**
    1) a = b赋值时会创建一个对b的新引用；对不可变对象是创建一个b的副本；
    2) 对于可变对象可以使用两种复制：浅复制和深复制；
        * 浅复制创建一个新对象，它包含对原始对象中包含的项的引用；新添加进去
          的项是各自的；如果修该原有项，那被复制对象也相应改变；

## **5. 第一类对象**
    1) 能够使用标示符命名的所有对象都具有相同状态，能命名的所有对象都可以当
       作数据处理；
    2) 一切对象都是第一类的；
        * 深复制创建一个新对象，并递归复制它所包含的所有对象(copy.deepcopy)

## **6. 表示数据的内置类型**
    1) 内置类型
        * Type(None)    null对象None
        * int           整数
        * Long          任意精度的整数(仅Python 2)
        * float         浮点数
        * complex       复数
        * bool          布尔值
        * str           字符串
        * unicode       Unicode字符串(仅Python 2)
        * list          列表
        * tuple         元组
        * xrange        xrange创建的整数范围(Python 3中为range)
        * dict          字典
        * set           可变集合
        * frozenset     不可变集合
    2) None类型
        表示一个null对象None，函数没显示返回值则返回该对象；布尔求值为False
    3) 数字类型
        * 包括：布尔，整数，长整数，浮点数和复数；
        * 是不可变的；
        * Python 2中如果x类型是Long，isinstance(x, int)为False；
    4) 序列类型
        * 包含字符串，列表和元组；字符串是字符序列，列表和元组是任意对象的序
          列；字符串和元组不可变，列表是可变的；
        * 所有序列的通用操作：
            s[i]                返回序列元素i
            s[i:j]              返回一个切片
            s[i:j:stride]       返回一个扩展切片
            len(s)              s中元素数
            min(s)              s中最小值
            max(s)              s中最大值
            sum(s[, initial])   s中各项的和
            all(s)              s中所有项是否为True
            any(s)              s中任意项是否为True
        * 可变序列的操作：
            s[i] = v            项目赋值
            s[i:j] = t          切片赋值
            s[i:j:stride] = t   扩展切片赋值
            del s[i]            项目删除
            del s[i:j]          切片删除
            del s[i:j:stride]   扩展切片删除
        * 列表方法：
            list(s)             将s转换为一个列表
            s.append(x)         将x追加到s
            s.extend(t)         将新列表t追加到s
            s.count(x)          s中x出现的次数
            s.index(x[,start[,stop]])
                                s[i]==x.start返回最小的i，stop指定起始和结束
            s.insert(i, x)      在索引i插入x
            s.pop([i])          返回元素i并移除；如省略i，返回最后一个元素
            s.remove(x)         搜索x并从s中删除，没有则出错
            s.reverse()         颠倒s中所有元素
            s.sort([key[,reverse]])
                                对s排序，key是键函数，reverse表示是否倒序
        * 字符串
            Python 2中提供字节字符串(包含二进制数据和NULL字节)和Unicode字符
            串(未编码的Unicode字符序列，内部是16bit整数)；
            s.encode()/s.decode()在字符串和指定字符编码之间转换；Python 3中
            encode只能用于字符串，decode()方法只能用于字节数据类型；
            s.captitalize()       首字符变大写
            s.center(width[,pad]) 长width的字段内将字符串居中,pad是填充字符
            s.count(sub[,start[,end]])    计算s中sub出现的次数
            s.decode([encoding[,errors]]) 
                                  解码s(s是字节字符串)并返回一Unicode字符串
            s.encode([encoding[,errors]]) 返回解码的字符串(s是Unicode字符串)
            s.endswith(suffix[,start[,end]])
                                  检查字符串是否以suffix结尾
            s.expandtabs([tabsize])       使用空格替换制表符
            s.find(sub[,start[,end]])     找到sub首次出现位置，否则返回-1
            s.format(*args, **kwargs)     格式化s
            s.index(sub[,start[,end]])    找到sub首次出现的位置，否则报错
            s.isalnum()           检查所有字符是否都为字母或数字
            s.isalpha()           检查所有字符是否都为字母
            s.isdigit()           检查所有字符是否都是数字
            s.islower()           检查所有字符是否都是小写
            s.isspace()           检查所有字符是否都是空白
            s.istitle()           检查字符串是否为标题字符串(单词首字母大写)
            s.isupper()           检查所有字符是否都是大写
            s.join(t)             使用s为分隔符连接序列t中的字符串
            s.ljust(width[,fill]) 在长度width的字符串内左对齐s
            s.lower()             转换为小写形式
            s.lstrip([chrs])      删掉chrs前面的空白或字符
            s.partition(sep)      使用sep划分s,返回元组(head,sep,tail)
            s.replace(old,new[,maxreplace]) 替换一个子字符串
            s.rfind(sub[,start[,end]])      找到sub最后出现的位置
            s.rindex(sub[,start[,end]])     找到sub最后出现的位置,否则报错
            s.rjust(width[,fill]) 在长度为width字符串内右对齐s
            s.rpartition(sep)     使用sep划分s，从结尾开始搜索
            s.rsplit([sep[,maxsplit]])      使用sep将s从后往前划分
            s.rstrip([chrs])      删掉chrs尾部的空白字符串
            s.split([sep[,maxsplit]])       使用sep划分一个字符串
            s.splitlines([keepends])        将字符串分为一个行列表
            s.startswith(prefix[,start[,end]])  检查s是否以prefix开头
            s.strip([chrs])       删掉chrs开头和结尾的空白或字符
            s.swapcase()          大写转换为小写，或相反
            s.title()             将字符串转换为标题格式
            s.translate(table[,deletechars])
                                  用字符转换表table转换字符串,删deletechars
                                  中的字符
            s.upper()             将字符串转换为大写形式
            s.zfill(width)        字符左边填充0，直至其宽度为width
        * xrange()对象
            xrange([i,] j [, stride])创建表示一个整数范围k(i<=k<j), i默认0,
            stride默认为1；
            Python 3中xrange()修改为range()
    5) 映射类型
        * 可以通过数字、字符串和其他对象进行索引；映射是可变的；
        * 任何不可变对象都可以作为字典键值；
        * 字典的方法和操作：
            len(m)                返回m中的项目数
            m[k]                  返回m中键k的项
            m[k] = x              将m[k]的值设为x
            del m[k]              从m删除m[k]
            k in m                如果k是m中的键，返回True
            m.clear()             删除m中所有项
            m.copy()              返回m的一个副本
            m.fromkeys(s[,value]) 创建一个新字典并将序列s中的所有元素作为新
                                  字典的键，这些键的值均为value
            m.get(k[,v])          返回m[k],找不到返回v
            m.has_key(k)          m中存在k，返回True，否则False(Python3废弃)
            m.items()             返回由(key,value)对组成的一个序列
            m.keys()              返回键值组成的一个序列
            m.pop(k[,default])    找到m[k],返回m[k]并从m删除它；如有default
                                  则返回这个值，没有则引发KeyError异常
            m.popitem()           从m删除一个随机(key,value)对，并返回该元组
            m.setdefault(k[,v])   找到m[k]返回m[k]; 否则返回v并设置m[k]为v
            m.update(b)           将b中所有对象添加到m中
            m.values()            返回m中所有值的一个序列
    6) 集合类型
        * 唯一项的无序集；不提供索引或切片操作；不存在相关的键值；集合中的项
          目是不可变的；
        * 集合的方法和操作
            len(s)                返回s中的项目数
            s.copy()              s的一个副本
            s.difference(t)       求差集，返回s中有t中不存在的项
            s.intersection(t)     求交集，返回同时在s和t中的项
            s.isdisjoint(t)       如果s和t没有相同的项，返回True
            s.issubset(t)         如果s是t的一个子集，返回True
            s.issuperset(t)       如果s是t的一个超集，返回True
            s.symmetric_difference(t) 求对称差集,在s或t中,不同时在两集合中
            s.union(t)            求并集，返回所有在s或t中的项
        * 可变集合类型的方法
            s.add(item)           将item添加到s中；如item已在，则无任何效果
            s.clear()             删除s中的所有项
            s.difference_update(t)    从s中删除同时也在t中的所有项
            s.discard(item)       从s中删除item, 如item不在s中，则无任何效果
            s.intersection_update(t)  计算s与t的交集，结果放入s中
            s.pop()               返回任意集合元素，并从s中删除
            s.remove(item)        从s中删除item,如item不在s中,引发KeyError
            s.symmetric_difference_update(t)
                                  计算s与t的对称差集，并将结果放入s
            s.update(t)           t中所有项添加到s中

## **7. 表示程序结构的内置类型**
    1) 程序结构的内置Python类型
        可调用    types.BuiltinFunctionType     内部函数或方法
                  type                          内置类型和类的方法
                  object                        所有类型的类的祖先
                  types.FunctionType            用户定义的函数
                  types.MethodType              类方法
        模块      types.ModuleType              模块
        类        object                        所有类型的类的祖先
        类型      type                          内置类型和类的类型
> ### **7.1 可调用类型**
    1) 用户定义的函数(def语句或lambda运算符在模块级别上创建的可调用对象)
    2) 用户定义函数的属性
        * f.__doc__       文档字符串
        * f.__name__      函数名称
        * f.__dict__      包含函数属性的字典
        * f.__code__      字节编码的代码
        * f.__defaults__  包含默认参数的元组
        * f.__globals__   定义全局命名空间的字典
        * f.__closure__   包含与嵌套作用域相关数据的元组
    3) 方法是在类中定义的函数(实例方法，类方法和静态方法)；
        class Foo(object):
          def instance_method(self, arg):
            statements
          @classmethod
          def class_method(cls, arg):
            statements
          @staticmethod
          def static_method(arg):
            statements
    4) 方法对象的属性(绑定方法和非绑定方法的对象类型都是types.MethodType)
        * m.__doc__       文档字符串
        * m.__name__      方法名称
        * m.__class__     定义该方法的类
        * m.__func__      实现方法的函数对象
        * m.__self__      与方法相关的实例(如果是非绑定方法，则为None)
    5) types.BuiltinFunctionType表示C/C++实现的函数和方法，内置方法的属性如
       下：
        * b.__doc__       文档字符串
        * b.__name__      函数/方法名称
        * b.__self__      与方法相关的实例(如果是绑定方法)
    6) 类对象和实例可当作可调用对象进行操作；如果实例定义了__call__()就可以
       模拟函数的行为；
