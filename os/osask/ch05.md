# **结构体, 文字显示与GDT/IDT初始化** #
***


## **1. 接收启动信息** ##
    1) 对画面模式中, VRAM地址以及画面的宽高应该直接取汇编里面存储的值, 这样
       在画面模式改变之后, 还可以正常运行
    2) 具体例子请参见./os-src/toyos16/


## **2. 试用结构体** ##
    1) 使用结构体可以解决冗长的取值代码
    2) 具体例子请参见./os-src/toyos17/


## **3. 试用箭头记号** ##
    1) 在程序中对结构体成员使用->, 同时可以去掉一些不必要的变量, 使整体代码
       更为清爽
    2) 具体例子请参见./os-src/toyos18/


## **4. 显示字符** ##
    1) 在32位模式下, 可以使用8 * 16的像素点阵来表示, 可以使用0和1来表示, 
       8"位"是一个字节, 那么显示一个字符就是16字节
    2) 我们只要在8 * 16的点阵中, 对需要显示的字符轮廓的"位"上填上与背景色不
       同的颜色即可显示出我们需要的字符
    3) 具体例子请参见./os-src/toyos19/


## **5. 增加字符** ##
    1) 我们直接导入一个字库, 这样就可以直接使用里面的字符了
    2) 该字库中含有256个字符, A的字符编码是0x41, 其放在charlib + 0x41 * 16开
       始的16个字节里面; C语言中A的字符编码可以用'A'来表示, 所以可以将上面的
       写成charlib + 'A' * 16
    3) 具体例子请参见./os-src/toyos20/


## **6. 显示字符串** ##
    1) 一个字符一个字符的显示太麻烦了, 我们可以制作一个显示字符串的函数来替
       换
    2) 具体例子请参见./os-src/toyos21/


## **7. 显示变量的值** ##
    1) 在调试我们所写的操作系统的时候, 没有别的调试器可以使用, 我们只能将变
       量的值显示出来
    2) 我们可以使用一个针对该toyos特制的stdio库, 其中包含了一个sprintf, 这样
       我们就可以将变量转换成字符串了, 以便在屏幕上显示出来
    3) 具体例子请参见./os-src/toyos22/


## **8. 显示鼠标指针** ##
    1) 可以将鼠标指针的大小定为16 * 16, 先准备16 * 16的字节空间, 然后再往里
       面写入鼠标指针的数据信息
    2) 由于鼠标指针, 并非整个16 * 16的空间都使用了, 除了指针其余的空间部分是
       为了显示桌面的背景色, 这样就需要将buffer中的数据拷贝到VRAM中去
    3) 具体例子请参见./os-src/toyos23/



## **9. GDT和IDT的初始化** ##
    1) GDT和IDT是与CPU相关的设定
    2) 分段, 就是按照自己喜欢的方式, 将4GB的内存分成很多块, 每一块的起始地址
       都看做0来处理;
       这很方便, 有了这个功能, 任何程序都可以先写上一句org 0x0; 如同这样分割
       出来的块就是段
    3) 表示一个段, 需要的信息:
        * 段的大小是多少
        * 段的起始地址在哪里
        * 段的管理属性(禁止写入, 禁止执行, 系统专用)
       CPU用8个字节(64位)的数据来表示这些数据信息, 但是用于指定段的寄存器只
       有16位(32位模式下也是16位);
       我们可以采用调色板的方法, 先有一个段号, 存放在寄存器里, 然后预先设定
       好段号与段的对应关系;
       段号可以使用0~8191(由于CPU设计上的原因, 段寄存器的低3位不能使用, 因此
       能够使用的只有13位)
    4) GDT(global segment descriptor table), 全局段号记录表; 将这些数据整齐
       排列在内存的某个地方, 然后将内存的起始地址和有效设定个数放在CPU内称作
       GDTR的特殊寄存器中, 设定就完成了
    5) IDT(interrupt descriptor table), 中断记录表; 当CPU遇到外部状况变化, 
       或者是内部偶然发生某些错误时, 会临时切换过去处理这种突发事件; 这便是
       中断功能
    6) 具体例子请参见./os-src/toyos24/

