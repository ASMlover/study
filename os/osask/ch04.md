# **C语言与画面显示练习** #
***


## **1. 用C语言实现内存写入** ##
    1) 要想在OS中显示什么东西, 直接在VRAM中写入即可
    2) 针对汇编中的参数
        * 第一个数字存放地址 [esp + 4]
        * 第二个数字存放地址 [esp + 8]
        * ...
    3) 在于C语言联合使用的时候, 能够自由使用的寄存器是eax, ecx, edx; 而其他
       的寄存器只能使用其值, 不能改变其值(因为它们在C编译后的机器语言中记录
       重要的值)
    4) instrset用于指定使用什么样的CPU架构
        8086->80186->286->386->486->Pentium->PentiumPro->PentiumII->
        PentiumIII->Pentium4->...
        386以后CPU是32位的
    5) 具体例子请参见./os-src/toyos10/


## **2. 条纹图案** ##
    1) 我们只需要修改写入的内容即可实现(i & 0x0f)
    2) CPU在处理图形数据的时候, 最主要的是0和1的排列方式(二进制)
    3) 具体例子请参见./os-src/toyos11/


## **3. 指针** ##
    1) 在对某块地址赋值的时候不是非要使用函数, 也可以使用指针直接赋值
    2) 直接使用指针指向需要写入内容的地址, 就可以对这块地址赋值了
    3) 关于指针, 可以使用各种方式来指定的地址赋值
    4) 具体例子请参见./os-src/toyos12/


## **4. 色号设定** ##
    1) 320 * 200的8位颜色模式, 色号是使用8位数
    2) 8位颜色模式, 是随意指定0~255所对应的颜色, 这种方式就是调色板
    3) 常用的颜色
        * #000000 黑
        * #ff0000 亮红
        * #00ff00 亮绿
        * #ffff00 亮黄
        * #0000ff 亮蓝
        * #ff00ff 亮紫
        * #00ffff 浅亮蓝
        * #ffffff 白
        * #c6c6c6 亮灰
        * #840000 暗红
        * #008400 暗绿
        * #848400 暗黄
        * #000084 暗蓝
        * #840084 暗紫
        * #008484 浅暗蓝
        * #848484 暗灰
    4) char c[10]; 相当于汇编语言里面
        c:
          resb  10
        但汇编里面保证内容都是0, C语言中可能是未初始化的值
    5) CPU与各种设备相连, 就会向这些设备发送电信号, 或者从这些设备接收电信号
        * in指令: 从设备取得电信号
        * out指令: 向设备发送电信号
        * 为了区别不同的设备, 需要设备编号, 即端口(port)
    6) 调色板访问步骤
        * 首先在一连串的访问中屏蔽中断(cli即可屏蔽中断)
        * 将想要设定的调色板号码写入0x03c8, 然后按R, G, B的顺序写入0x03c9; 
          如果还想继续设定下一个调色板, 则省略调色板号, 再按R, G, B的顺序写
          入0x03c9即可
        * 如果想读出当前调色板的状态, 首先要将调色板的号码写入0x03c7, 再从
          0x03c9读取3次; 读出的顺序依次是R, G, B; 如果想继续读出下一个调色板
          同样省略调色板号的设定, 按RGB依次读取即可
        * 如果最初执行了cli, 那么最后要执行sti
    7) cli 将中断标志置为0 
    8) sti 将中断标志置为1 
    9) pushfd(push flags double-word), 将标志位的值按照双字长压入栈
    10) popfd(pop flags double-word), 按双字长将标志位从栈中弹出
    11) 具体例子请参见./os-src/toyos13/


## **5. 绘制矩形** ##
    1) 在VRAM上(320 * 200)个像素, 那坐标(x, y)对于VRAM的地址的计算公式为
        0xa0000 + x + y * 320 
    2) 具体例子请参见./os-src/toyos14/


## **6. 显示任务条** ##
    1) 绘制一个简易窗口, 包含一个任务条
    2) 具体例子请参见./os-src/toyos15/
