# **增加命令行窗口** #
***



## **1. 蜂鸣器发声** ##
    1) 我们来为操作系统添加蜂鸣器的用户API接口
    2) 其实蜂鸣器发声和定时器一样, 都是由PIT来控制的, 而PIT位于芯片组中, 因
       此所有型号的电脑都可以使用
    3) 蜂鸣器发声的控制
       音高操作
        * al = 0xb6; out(0x43, al);
        * al = 设定值的低位8bit; out(0x42, al);
        * al = 设定值的高位8bit; out(0x42, al);
        * 设定值为0时当做65536来处理
        * 发声的音高为时钟除以设定值, 也就是说设定值为1000时相当于发出
          1.19318kHz的声音; 设定值为10000时相当于119.318Hz; 因此设定2712即可
          发出约440Hz的声音
    4) 蜂鸣器ON/OFF
        * 使用I/O端口0x61控制
        * ON: in(al, 0x61); al |= 0x03; al &= 0x0f; out(0x61, al);
        * OFF: in(al, 0x61); al &= 0xd; out(0x61, al);
    5) 蜂鸣器发声API
        * edx = 20
        * eax = 声音频率(单位为mHz, 毫赫兹)
        当eax = 4400000时, 则发出440Hz的声音, 设置为0则表示停止声音
    6) 这些在真机上运行可以听到声音变化, 但是在qemu模拟器中则无能为力
    7) 具体例子请参见./os-src/toyosbc/




## **2. 添加更多的颜色** ##
    1) 现在我们的系统只用了16中颜色, 但是在256色显示模式下则还有240中颜色, 
       我们来显示更多的颜色
    2) 我们可以为光的三原色red, green, blue中每一种颜色赋予6个色阶, 这样我们
       就可以定义了6 * 6 * 6中颜色了
    3) 具体例子请参见./os-src/toyosbd/



## **3. 添加更多的颜色** ##
    1) 我们可以用两种颜色交替排列, 看上去就像这两种颜色混合在一起一样
    2) 具体例子请参见./os-src/toyosbe/



## **4. 窗口初始位置** ##
    1) 我们让窗口总是显示在画面中央, 来设置窗口的初始位置
    2) 同时我们还会让新运行的应用程序窗口显示在除了鼠标外的最顶层
    3) 具体例子请参见./os-src/toyosbf/



## **5. 增加命令行窗口** ##
    1) 现在我们的系统还不能同时启动两个应用程序
    2) 我们实现一些简单的解决方法, 开启两个命令行窗口来启动两个应用程序
    3) 具体例子请参见./os-src/toyosc0/


## **6. 增加命令行窗口** ##
    1) 虽然我们显示了两个命令行窗口, 但是其中一个窗口运行的结果会显示到另一
       个窗口上, 是因为我们在toy_api中将命令行窗口的地址定死了
    2) 每个任务都有自己的task结构, 我们只要将console保存在task结构中就可以了
       同样的道理我们也可以加上ds_base字段, 不同的命令行窗口使用不同的段地址
    3) 具体例子请参见./os-src/toyosc1/
