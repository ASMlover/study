# **定时器** #
***


## **1. 使用定时器** ##
    1) 定时器, 即是每隔一段时间向CPU发送一个中断信号
    2) 如果没有定时器, 就不能使用hlt指令, 因为完成这个指令所需要的时钟周期不
       是一个固定的值; 一旦执行hlt程序就不知道时间了
    3) 有了定时器, 只需要在中断处理程序中计算定时器中断发生的次数就可以知道
       时间了;
    4) 要管理定时器, 只需要对PIT(programmable interval timer)进行设定就可以
       了; 可以设置PIT让定时器每隔多少秒就发生一次中断; 
    5) PIT连接着IRQ0, 所以只要设定了PIT就可以设定IRQ0的中断间隔了
    6) IRQ0的中断周期变更:
        * al=0x34; out(0x43, al);
        * al=中断周期的低8位; out(0x40, al)
        * al=中断周期的高8位; out(0x40, al)
        * 如果指定中断周期为0, 则会被看做是65536; 实际的中断产生的频率是单位
          时间时钟周期(主频)/设定的数值; 如果设定值是11932, 中断产生的频率大
          约是100Hz, 也就是每10ms发生一次中断
          (11932 -> 0x2e9c)
    7) 具体例子请参见./os-src/toyos54/


## **2. 计量时间** ##
    1) 在timer中断中设置一个计量器, 没发生一次中断就增加1 
    2) 这样我们就可以以此来计量时间了, 将这个数值显示到窗口上(100次/秒)
    3) 具体例子请参见./os-src/toyos55/


## **3. 超时功能** ##
    1) 超时功能, 即是要操作系统过多少时间之后通知用户, 以便用户干xxx事情
    2) 在设置超时的时候, 如果设定还没有完全结束, IRQ0的中断就进来的话, 会引
       起混乱, 因此我们应该先禁止中断, 然后完成设定后在恢复中断
