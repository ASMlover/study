     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_load_gdtr
     7 00000000                                 	EXTERN	_load_idtr
     8 00000000                                 	EXTERN	_asm_interrupt_handler0c
     9 00000000                                 	EXTERN	_asm_interrupt_handler0d
    10 00000000                                 	EXTERN	_asm_interrupt_handler20
    11 00000000                                 	EXTERN	_asm_interrupt_handler21
    12 00000000                                 	EXTERN	_asm_interrupt_handler27
    13 00000000                                 	EXTERN	_asm_interrupt_handler2c
    14 00000000                                 	EXTERN	_asm_toy_api
    15 00000000                                 [FILE "desc_tbl.c"]
    16                                          [SECTION .text]
    17 00000000                                 	GLOBAL	_set_segment_descriptor
    18 00000000                                 _set_segment_descriptor:
    19 00000000 55                              	PUSH	EBP
    20 00000001 89 E5                           	MOV	EBP,ESP
    21 00000003 53                              	PUSH	EBX
    22 00000004 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
    23 00000007 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
    24 0000000A 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
    25 0000000D 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    26 00000010 81 FA 000FFFFF                  	CMP	EDX,1048575
    27 00000016 76 08                           	JBE	L2
    28 00000018 C1 EA 0C                        	SHR	EDX,12
    29 0000001B 0D 00008000                     	OR	EAX,32768
    30 00000020                                 L2:
    31 00000020 66 89 13                        	MOV	WORD [EBX],DX
    32 00000023 88 43 05                        	MOV	BYTE [5+EBX],AL
    33 00000026 C1 EA 10                        	SHR	EDX,16
    34 00000029 C1 F8 08                        	SAR	EAX,8
    35 0000002C 83 E2 0F                        	AND	EDX,15
    36 0000002F 66 89 4B 02                     	MOV	WORD [2+EBX],CX
    37 00000033 83 E0 F0                        	AND	EAX,-16
    38 00000036 C1 F9 10                        	SAR	ECX,16
    39 00000039 09 C2                           	OR	EDX,EAX
    40 0000003B 88 4B 04                        	MOV	BYTE [4+EBX],CL
    41 0000003E 88 53 06                        	MOV	BYTE [6+EBX],DL
    42 00000041 C1 F9 08                        	SAR	ECX,8
    43 00000044 88 4B 07                        	MOV	BYTE [7+EBX],CL
    44 00000047 5B                              	POP	EBX
    45 00000048 5D                              	POP	EBP
    46 00000049 C3                              	RET
    47 0000004A                                 _set_gate_descriptor:
    48 0000004A 55                              	PUSH	EBP
    49 0000004B 89 E5                           	MOV	EBP,ESP
    50 0000004D 53                              	PUSH	EBX
    51 0000004E 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    52 00000051 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
    53 00000054 8B 5D 14                        	MOV	EBX,DWORD [20+EBP]
    54 00000057 8B 4D 0C                        	MOV	ECX,DWORD [12+EBP]
    55 0000005A 66 89 42 02                     	MOV	WORD [2+EDX],AX
    56 0000005E 88 5A 05                        	MOV	BYTE [5+EDX],BL
    57 00000061 66 89 0A                        	MOV	WORD [EDX],CX
    58 00000064 89 D8                           	MOV	EAX,EBX
    59 00000066 C1 F8 08                        	SAR	EAX,8
    60 00000069 C1 F9 10                        	SAR	ECX,16
    61 0000006C 88 42 04                        	MOV	BYTE [4+EDX],AL
    62 0000006F 66 89 4A 06                     	MOV	WORD [6+EDX],CX
    63 00000073 5B                              	POP	EBX
    64 00000074 5D                              	POP	EBP
    65 00000075 C3                              	RET
    66 00000076                                 	GLOBAL	_init_gdt_idt
    67 00000076                                 _init_gdt_idt:
    68 00000076 55                              	PUSH	EBP
    69 00000077 89 E5                           	MOV	EBP,ESP
    70 00000079 56                              	PUSH	ESI
    71 0000007A 53                              	PUSH	EBX
    72 0000007B BE 00270000                     	MOV	ESI,2555904
    73 00000080 BB 00001FFF                     	MOV	EBX,8191
    74 00000085                                 L9:
    75 00000085 6A 00                           	PUSH	0
    76 00000087 6A 00                           	PUSH	0
    77 00000089 6A 00                           	PUSH	0
    78 0000008B 56                              	PUSH	ESI
    79 0000008C 83 C6 08                        	ADD	ESI,8
    80 0000008F E8 FFFFFF6C                     	CALL	_set_segment_descriptor
    81 00000094 83 C4 10                        	ADD	ESP,16
    82 00000097 4B                              	DEC	EBX
    83 00000098 79 EB                           	JNS	L9
    84 0000009A 68 00004092                     	PUSH	16530
    85 0000009F BE 0026F800                     	MOV	ESI,2553856
    86 000000A4 6A 00                           	PUSH	0
    87 000000A6 BB 000000FE                     	MOV	EBX,254
    88 000000AB 6A FF                           	PUSH	-1
    89 000000AD 68 00270008                     	PUSH	2555912
    90 000000B2 E8 FFFFFF49                     	CALL	_set_segment_descriptor
    91 000000B7 68 0000409A                     	PUSH	16538
    92 000000BC 68 00280000                     	PUSH	2621440
    93 000000C1 68 0007FFFF                     	PUSH	524287
    94 000000C6 68 00270010                     	PUSH	2555920
    95 000000CB E8 FFFFFF30                     	CALL	_set_segment_descriptor
    96 000000D0 83 C4 20                        	ADD	ESP,32
    97 000000D3 68 00270000                     	PUSH	2555904
    98 000000D8 68 0000FFFF                     	PUSH	65535
    99 000000DD E8 [00000000]                   	CALL	_load_gdtr
   100 000000E2 58                              	POP	EAX
   101 000000E3 5A                              	POP	EDX
   102 000000E4                                 L14:
   103 000000E4 6A 00                           	PUSH	0
   104 000000E6 6A 00                           	PUSH	0
   105 000000E8 6A 00                           	PUSH	0
   106 000000EA 56                              	PUSH	ESI
   107 000000EB 83 C6 08                        	ADD	ESI,8
   108 000000EE E8 FFFFFF57                     	CALL	_set_gate_descriptor
   109 000000F3 83 C4 10                        	ADD	ESP,16
   110 000000F6 4B                              	DEC	EBX
   111 000000F7 79 EB                           	JNS	L14
   112 000000F9 68 0026F800                     	PUSH	2553856
   113 000000FE 68 000007FF                     	PUSH	2047
   114 00000103 E8 [00000000]                   	CALL	_load_idtr
   115 00000108 68 0000008E                     	PUSH	142
   116 0000010D 6A 10                           	PUSH	16
   117 0000010F 68 [00000000]                   	PUSH	_asm_interrupt_handler0c
   118 00000114 68 0026F860                     	PUSH	2553952
   119 00000119 E8 FFFFFF2C                     	CALL	_set_gate_descriptor
   120 0000011E 68 0000008E                     	PUSH	142
   121 00000123 6A 10                           	PUSH	16
   122 00000125 68 [00000000]                   	PUSH	_asm_interrupt_handler0d
   123 0000012A 68 0026F868                     	PUSH	2553960
   124 0000012F E8 FFFFFF16                     	CALL	_set_gate_descriptor
   125 00000134 83 C4 28                        	ADD	ESP,40
   126 00000137 68 0000008E                     	PUSH	142
   127 0000013C 6A 10                           	PUSH	16
   128 0000013E 68 [00000000]                   	PUSH	_asm_interrupt_handler20
   129 00000143 68 0026F900                     	PUSH	2554112
   130 00000148 E8 FFFFFEFD                     	CALL	_set_gate_descriptor
   131 0000014D 68 0000008E                     	PUSH	142
   132 00000152 6A 10                           	PUSH	16
   133 00000154 68 [00000000]                   	PUSH	_asm_interrupt_handler21
   134 00000159 68 0026F908                     	PUSH	2554120
   135 0000015E E8 FFFFFEE7                     	CALL	_set_gate_descriptor
   136 00000163 83 C4 20                        	ADD	ESP,32
   137 00000166 68 0000008E                     	PUSH	142
   138 0000016B 6A 10                           	PUSH	16
   139 0000016D 68 [00000000]                   	PUSH	_asm_interrupt_handler27
   140 00000172 68 0026F938                     	PUSH	2554168
   141 00000177 E8 FFFFFECE                     	CALL	_set_gate_descriptor
   142 0000017C 68 0000008E                     	PUSH	142
   143 00000181 6A 10                           	PUSH	16
   144 00000183 68 [00000000]                   	PUSH	_asm_interrupt_handler2c
   145 00000188 68 0026F960                     	PUSH	2554208
   146 0000018D E8 FFFFFEB8                     	CALL	_set_gate_descriptor
   147 00000192 83 C4 20                        	ADD	ESP,32
   148 00000195 68 000000EE                     	PUSH	238
   149 0000019A 6A 10                           	PUSH	16
   150 0000019C 68 [00000000]                   	PUSH	_asm_toy_api
   151 000001A1 68 0026FA00                     	PUSH	2554368
   152 000001A6 E8 FFFFFE9F                     	CALL	_set_gate_descriptor
   153 000001AB 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   154 000001AE 5B                              	POP	EBX
   155 000001AF 5E                              	POP	ESI
   156 000001B0 5D                              	POP	EBP
   157 000001B1 C3                              	RET
