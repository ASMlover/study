{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://minicli4.local/spec/tool-calls.schema.json",
  "title": "MiniCLI4 Tool Calling Contract",
  "description": "Function tool definitions and tool call payloads exchanged with GLM-5.",
  "type": "object",
  "additionalProperties": false,
  "required": ["tools", "tool_call"],
  "properties": {
    "tools": {
      "type": "array",
      "minItems": 6,
      "items": {
        "$ref": "#/$defs/tool_definition"
      }
    },
    "tool_call": {
      "$ref": "#/$defs/tool_call"
    }
  },
  "$defs": {
    "tool_name": {
      "type": "string",
      "enum": [
        "read_file",
        "write_file",
        "list_dir",
        "grep_text",
        "run_shell",
        "project_tree",
        "session_export"
      ]
    },
    "tool_definition": {
      "type": "object",
      "additionalProperties": false,
      "required": ["type", "function"],
      "properties": {
        "type": {
          "type": "string",
          "const": "function"
        },
        "function": {
          "type": "object",
          "additionalProperties": false,
          "required": ["name", "description", "parameters"],
          "properties": {
            "name": { "$ref": "#/$defs/tool_name" },
            "description": { "type": "string", "minLength": 1 },
            "parameters": {
              "type": "object",
              "required": ["type", "properties"],
              "properties": {
                "type": { "type": "string", "const": "object" },
                "properties": { "type": "object" },
                "required": {
                  "type": "array",
                  "items": { "type": "string", "minLength": 1 }
                }
              }
            }
          }
        }
      }
    },
    "tool_call": {
      "type": "object",
      "additionalProperties": false,
      "required": ["id", "type", "function"],
      "properties": {
        "id": {
          "type": "string",
          "minLength": 1
        },
        "type": {
          "type": "string",
          "const": "function"
        },
        "function": {
          "type": "object",
          "additionalProperties": false,
          "required": ["name", "arguments"],
          "properties": {
            "name": { "$ref": "#/$defs/tool_name" },
            "arguments": {
              "oneOf": [
                { "type": "string", "minLength": 2 },
                { "type": "object" }
              ],
              "description": "Arguments may be JSON-encoded string or parsed object."
            }
          }
        }
      }
    }
  },
  "examples": [
    {
      "tools": [
        {
          "type": "function",
          "function": {
            "name": "read_file",
            "description": "Read a UTF-8 text file.",
            "parameters": {
              "type": "object",
              "properties": {
                "path": { "type": "string" }
              },
              "required": ["path"]
            }
          }
        }
      ],
      "tool_call": {
        "id": "call_1",
        "type": "function",
        "function": {
          "name": "read_file",
          "arguments": "{\"path\":\"README.md\"}"
        }
      }
    }
  ]
}
